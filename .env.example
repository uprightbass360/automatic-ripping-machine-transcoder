# ARM Transcoder Environment Configuration
# Copy this file to .env and customize for your environment

# ========== TIMEZONE ==========
TZ=America/New_York

# ========== USER/GROUP IDS ==========
# Match these to your ARM container for consistent file permissions
ARM_UID=1001
ARM_GID=1000

# ========== NFS PATHS ==========
# These paths should be NFS mounts shared between ARM ripper and transcoder
# Based on your ARM_MEDIA_PATH, the raw files will be in a subdirectory
NFS_RAW_PATH=/nfs/files/Video/Import/raw
NFS_COMPLETED_PATH=/nfs/files/Video/Import/completed

# ========== LOCAL PATHS ==========
# Working directory for transcoding (local SSD recommended for speed)
WORK_PATH=./work

# Database storage (host directory mounted to /data/db in container)
DB_PATH=./data

# Presets directory
PRESET_PATH=./presets

# ========== AUTHENTICATION ==========
# Require API key for all endpoints (except webhook if WEBHOOK_SECRET is set)
REQUIRE_API_AUTH=false

# API keys (comma-separated)
# Format: "key1,key2,key3" or "admin:key1,readonly:key2"
# Example: API_KEYS=admin:abc123,readonly:def456
API_KEYS=

# ========== WEBHOOK ==========
# Port for webhook receiver
WEBHOOK_PORT=5000

# Webhook secret for ARM callbacks (X-Webhook-Secret header)
WEBHOOK_SECRET=

# ========== TRANSCODING ==========
# HandBrake preset name (from presets/nvenc_presets.json)
HANDBRAKE_PRESET=NVENC H.265 1080p

# Video encoder options:
#   NVIDIA:  nvenc_h265, nvenc_h264, hevc_nvenc, h264_nvenc
#   AMD:     vaapi_h265, vaapi_h264, hevc_vaapi, h264_vaapi (Linux/VAAPI)
#            amf_h265, amf_h264, hevc_amf, h264_amf (AMF)
#   Intel:   qsv_h265, qsv_h264, hevc_qsv, h264_qsv
#   Software: x265, x264
VIDEO_ENCODER=nvenc_h265

# Quality (CRF/CQ/QP): lower = better quality, larger file
# Recommended: 18-22 for NVENC/VAAPI/AMF, 20-24 for software
VIDEO_QUALITY=22

# ========== AMD GPU (VAAPI) ==========
# VAAPI render device path (only needed for AMD/Intel VAAPI encoding)
# VAAPI_DEVICE=/dev/dri/renderD128

# Audio: copy (passthrough), aac, ac3, eac3, flac, mp3
AUDIO_ENCODER=copy

# Subtitles: all, none, first
SUBTITLE_MODE=all

# ========== FILE HANDLING ==========
# Delete source files after successful transcode
DELETE_SOURCE=true

# Output file extension
OUTPUT_EXTENSION=mkv

# ========== ORGANIZATION ==========
# Subdirectories under COMPLETED_PATH
MOVIES_SUBDIR=movies
TV_SUBDIR=tv

# ========== PERFORMANCE ==========
# Max concurrent transcodes (1 for single GPU)
MAX_CONCURRENT=1

# Seconds to wait for source folder to stabilize before transcoding
STABILIZE_SECONDS=60

# ========== DISK SPACE ==========
# Minimum free disk space required before starting a transcode (GB)
MINIMUM_FREE_SPACE_GB=10

# ========== RETRY ==========
# Maximum retry attempts for failed jobs (0-10)
MAX_RETRY_COUNT=3

# ========== LOGGING ==========
LOG_LEVEL=INFO

# ========== ARM RIPPER (if running alongside) ==========
# Uncomment the arm-rippers service in docker-compose.yml to use these
ARM_PORT=8080
ARM_LOGS_PATH=/nfs/files/Containers/arm/logs
ARM_CONFIG_PATH=/nfs/files/Containers/arm/config
ARM_MUSIC_PATH=/nfs/files/Music/Import
ARM_CPUSET=3
